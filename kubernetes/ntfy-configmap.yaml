apiVersion: v1
kind: ConfigMap
metadata:
  name: ntfy-config
  namespace: p2000-forwarder
data:
  server.yml: |
    # ntfy server configuration
    # Public base URL for the service
    base-url: "https://ntfy.nrkdci.net"

    # Listen address (internal to pod)
    listen-http: ":80"

    # Cache file on persistent volume
    cache-file: "/var/cache/ntfy/cache.db"

    # Cache duration
    cache-duration: "12h"

    # Authentication
    # Enable auth-file based authentication
    # After deployment, create users with: ntfy user add <username>
    auth-file: "/var/cache/ntfy/user.db"
    auth-default-access: "deny-all"

    # Enable web UI
    enable-web: true

    # Attachment settings
    attachment-cache-dir: "/var/cache/ntfy/attachments"
    attachment-total-size-limit: "5G"
    attachment-file-size-limit: "15M"
    attachment-expiry-duration: "3h"

    # Message limits
    visitor-request-limit-burst: 60
    visitor-request-limit-replenish: "5s"
    visitor-message-daily-limit: 10000

    # Logging
    log-level: info
    log-format: json
